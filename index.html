<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>World Clock Converter</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      background: #007bff;
      font-size: 1.3em;
      font-weight: bold;
    }
    header button {
      background: transparent;
      border: none;
      font-size: 1.5em;
      color: #fff;
      cursor: pointer;
    }
    .city-list {
      margin: 20px;
    }
    .city-item {
      background: #222;
      margin: 10px 0;
      padding: 15px;
      border-radius: 8px;
      text-align: left;
      animation: fadeInUp 0.4s ease;
    }
    .city-item.removing {
      animation: slideOutLeft 0.4s ease forwards;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideOutLeft {
      from { opacity: 1; transform: translateX(0); }
      to { opacity: 0; transform: translateX(-100%); }
    }
    .city-name { font-weight: bold; }
    .city-time { color: #00c3ff; font-size: 1.3em; }

    /* Popup */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: #222;
      padding: 20px;
      border-radius: 8px;
      width: 90%;
      max-height: 80%;
      overflow-y: auto;
    }
    .search-bar {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
    }
    .city-option {
      padding: 10px;
      border-bottom: 1px solid #333;
      cursor: pointer;
    }
    .city-option:hover { background: #333; }
  </style>
</head>
<body>
  <header>
    <span>üåç World Clock</span>
    <button onclick="openModal()">Ôºã</button>
  </header>

  <div class="city-list" id="cityList"></div>

  <div class="modal" id="cityModal">
    <div class="modal-content">
      <input type="text" id="searchInput" class="search-bar" placeholder="Search city..." oninput="filterCities()" />
      <div id="cityOptions"></div>
    </div>
  </div>

<script>
const allCities = [
  "Africa/Cairo","Africa/Casablanca","Africa/Johannesburg",
  "America/Chicago","America/Los_Angeles","America/Mexico_City","America/New_York","America/Sao_Paulo","America/Toronto",
  "Asia/Bangkok","Asia/Dubai","Asia/Hong_Kong","Asia/Kolkata","Asia/Riyadh","Asia/Singapore","Asia/Tokyo",
  "Australia/Melbourne","Australia/Sydney",
  "Europe/Amsterdam","Europe/Athens","Europe/Berlin","Europe/Istanbul","Europe/Lisbon","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome",
  "Pacific/Auckland"
];
let cities = ["Asia/Kolkata","Asia/Riyadh"];

function cityName(tz) {
  return tz.split("/")[1].replace("_"," ");
}

function updateTimes() {
  const list = document.getElementById("cityList");
  list.innerHTML = "";
  const now = new Date();
  cities.forEach(city => {
    const optionsTime = { timeZone: city, hour: "2-digit", minute: "2-digit", hour12: true };
    const optionsDate = { timeZone: city, weekday:"long", month:"long", day:"numeric", year:"numeric" };
    const timeString = new Intl.DateTimeFormat("en-US", optionsTime).format(now);
    const dateString = new Intl.DateTimeFormat("en-US", optionsDate).format(now);

    const div = document.createElement("div");
    div.className = "city-item";
    div.innerHTML = `<div class="city-name">${cityName(city)}</div>
                     <div class="city-time">${timeString}</div>
                     <div class="city-date">${dateString}</div>`;

    let startX = 0;
    div.addEventListener("touchstart", e => startX = e.touches[0].clientX);
    div.addEventListener("touchend", e => {
      if (startX - e.changedTouches[0].clientX > 80) {
        div.classList.add("removing");
        setTimeout(() => removeCity(city), 400);
      }
    });

    list.appendChild(div);
  });
}

function removeCity(city) {
  cities = cities.filter(c => c !== city);
  updateTimes();
}

function openModal() {
  document.getElementById("cityModal").style.display = "flex";
  renderCityOptions();
}

function closeModal() {
  document.getElementById("cityModal").style.display = "none";
}

function renderCityOptions() {
  const container = document.getElementById("cityOptions");
  container.innerHTML = "";
  allCities.forEach(city => {
    const div = document.createElement("div");
    div.className = "city-option";
    div.textContent = cityName(city);
    div.onclick = () => { addCity(city); closeModal(); };
    container.appendChild(div);
  });
}

function filterCities() {
  const query = document.getElementById("searchInput").value.toLowerCase();
  const container = document.getElementById("cityOptions");
  container.innerHTML = "";
  allCities.filter(c => cityName(c).toLowerCase().includes(query)).forEach(city => {
    const div = document.createElement("div");
    div.className = "city-option";
    div.textContent = cityName(city);
    div.onclick = () => { addCity(city); closeModal(); };
    container.appendChild(div);
  });
}

function addCity(city) {
  if (!cities.includes(city)) {
    cities.push(city);
    updateTimes();
  }
}

setInterval(updateTimes, 60000);
updateTimes();

// Close modal if clicked outside
window.onclick = function(event) {
  if (event.target.id === "cityModal") closeModal();
}
</script>
</body>
</html>
